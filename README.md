# mini-etl-pipeline

Этот проект — простой пример пайплайна для обработки логов.  
Сначала он читает лог-файл построчно, потом фильтрует строки с ошибками (4XX и 5XX), и сохраняет только их в новый файл.

## Как работает

1. Берёт лог-файл, который указывается в `.env` (например, `access.log`)
2. Построчно читает строки
3. Каждую строку парсит в структуру
4. Пропускает всё, где ответ не ошибочный (2хх)
5. Ошибки пишет в `result.txt` (в формате JSON)
6. Если что-то пошло не так — пишет в лог ошибок

## Что нужно

- Файл `.env` с переменной:

```
LOG_FILE_NAME=access.log
```

## Как запустить

```bash
go run cmd/mini-etl-pipeline/main.go
```

## Что можно посмотреть

- `internal/pipeline` — основная логика пайплайна (reader → processor → writer)
- `internal/access-log` — парсинг логов
- `internal/process-log` — лог ошибок
- `result.txt` — сюда записываются только строки с ошибками

## Пример строки из result.txt

```json
{"path":"/api/v1","method":"GET","status":500,"timestamp":"2025-06-09T12:00:00Z","ip":"127.0.0.1","userAgent":"curl/7.81.0"}
```

## Завершение работы

Если нажать `Ctrl+C`, пайплайн аккуратно завершится и запишет всё, что успел обработать.
